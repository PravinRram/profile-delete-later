{% extends "base.html" %}
{% block content %}
  <section class="card centered">
    <h2>Reset Password</h2>
    {% if invalid %}
      <p class="form-error">This link is invalid or expired.</p>
    {% else %}
      <form method="post" class="form">
        {{ csrf_token() }}
        <label>New Password</label>
        <input
          type="password"
          name="password"
          id="reset-password"
          placeholder="Enter a new password"
          minlength="8"
          pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9]).{8,}"
          title="At least 8 characters, with uppercase, lowercase, and a number."
          required
        />
        {% if errors.password %}
          <div class="field-error">{{ errors.password }}</div>
        {% endif %}

        <label>Confirm Password</label>
        <input
          type="password"
          name="confirm_password"
          id="reset-confirm-password"
          placeholder="Confirm new password"
          minlength="8"
          pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9]).{8,}"
          title="At least 8 characters, with uppercase, lowercase, and a number."
          required
        />
        {% if errors.confirm_password %}
          <div class="field-error">{{ errors.confirm_password }}</div>
        {% endif %}

        <ul class="checklist" data-password-checklist>
          <li data-check="length">At least 8 characters</li>
          <li data-check="upper">Contains an uppercase letter</li>
          <li data-check="lower">Contains a lowercase letter</li>
          <li data-check="number">Contains a number</li>
        </ul>

        <button class="button primary full" type="submit">Update Password</button>
      </form>
    {% endif %}
  </section>
  <script src="{{ url_for('static', filename='auth/js/reset_password.js') }}"></script>
{% endblock %}
