{% extends "base.html" %}
{% block content %}
  <section class="card centered">
    <h2>Change Password</h2>
    <form method="post" class="form">
      {{ csrf_token() }}
      <label>Current Password</label>
      <input type="password" name="old_password" placeholder="Enter current password" />
      {% if errors.old_password %}
        <div class="field-error">{{ errors.old_password }}</div>
      {% endif %}

      <label>New Password</label>
      <input
        type="password"
        name="new_password"
        id="new-password"
        placeholder="Enter new password"
        minlength="8"
        pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9]).{8,}"
        title="At least 8 characters, with uppercase, lowercase, and a number."
        required
      />
      {% if errors.new_password %}
        <div class="field-error">{{ errors.new_password }}</div>
      {% endif %}

      <label>Confirm New Password</label>
      <input
        type="password"
        name="confirm_password"
        id="confirm-password"
        placeholder="Confirm new password"
        minlength="8"
        pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9]).{8,}"
        title="At least 8 characters, with uppercase, lowercase, and a number."
        required
      />
      {% if errors.confirm_password %}
        <div class="field-error">{{ errors.confirm_password }}</div>
      {% endif %}

      <ul class="checklist" data-password-checklist>
        <li data-check="length">At least 8 characters</li>
        <li data-check="upper">Contains an uppercase letter</li>
        <li data-check="lower">Contains a lowercase letter</li>
        <li data-check="number">Contains a number</li>
      </ul>

      <button class="button primary full" type="submit">Update Password</button>
    </form>
  </section>
  <script src="{{ url_for('static', filename='auth/js/change_password.js') }}"></script>
{% endblock %}
